<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" >
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>タスク編集画面</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
	</head>
	
	<body>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
		
		<header th:replace="~{common/header :: header_fragment}"></header>
		
		<main>
			
			<div class="text-center my-5">
				
				<h1>タスク編集ページ</h1>
				
					<div class="form-body"
						 th:with="url=${T(com.example.demo.constant.AppConst.Url)},
				 		  		  importance=${T(com.example.demo.constant.AppConst.TaskImportance)}">
						
						<form th:action="@{|${url.EDIT_TASK}/${task.taskId}|}" th:object="${form}" method="post">
							
							<div class="my-2">
								
								<label for="taskName" class="fw-bold form-label mt-5">タスク名</label>
								<input id="taskName" class="form-control w-25 mx-auto" type="text" th:field="*{name}" th:errorclass="is-invalid"/>
								<div class="invalid-feedback" th:errors="*{name}"></div>
								
								<label for="content" class="fw-bold form-label mt-4">詳細</label>
								<textarea id="content" class="form-control w-50 mx-auto" th:field="*{content}" th:errorclass="is-invalid"></textarea>
								<div class="invalid-feedback" th:errors="*{content}"></div>
								
								<label for="importance" class="fw-bold form-label mt-4">重要度</label>
								<select id="importance"  class="form-control w-25 mx-auto" th:field="*{importance}" th:errorclass="is-invalid">
									<option th:value="${importance.UNSET}" selected>指定なし</option>
									<option th:value="${importance.LOW}">低</option>
									<option th:value="${importance.MEDIUM}">中</option>
									<option th:value="${importance.HIGH}">高</option>
								</select>
								<div class="invalid-feedback" th:errors="*{importance}"></div>
								
								<label for="deadline" class="fw-bold form-label mt-4">期限</label>
								<input id="deadline" class="form-control w-25 mx-auto" type="date" th:field="*{deadline}" th:errorclass="is-invalid"/>
								<div class="invalid-feedback" th:errors="*{deadline}"></div>
								
								<label for="completedDate" class="fw-bold form-label mt-4">完了日</label>
								<input id="completedDate" class="form-control w-25 mx-auto" type="date" th:field="*{completedDate}" th:errorclass="is-invalid"/>
								<div class="invalid-feedback" th:errors="*{completedDate}"></div>
								
								<!--d-flex：この要素をフレックスボックスにする合図。中の要素がすべて横並びとなる。
									justify-content-center：中身を中央揃えにするという合図（フレックスボックス専用。デフォルトは左揃え。）-->
								<div class="mt-5 d-flex justify-content-center gap-5">
								
									<button class="btn btn-primary" type="submit">更新</button>
									
									<!--type="button"：これがないとボタンがsubmit扱いになりリクエストが飛んでしまう
										data-bs-toggle="modal"：基本的に隠しておいてボタンが押されたら「モーダル」を表示するという合図
										data-bs-target="#deleteModal"：モーダル本体との紐づけ-->
									<button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal">削除</button>
								
								</div>
								
							</div>
							
						</form>
						
						
						
						<!--tabindex="-1"：Tabキーを押してもこのウィンドウには反応させないようにするための記述（隠れているのに反応してしまうとユーザーが混乱する）-->
						<div class="modal fade" id="deleteModal" tabindex="-1">
						  <div class="modal-dialog">
						    <div class="modal-content">
						      <div class="modal-header">
						        <h5 class="modal-title">削除確認</h5>
						        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
						      </div>
						      <div class="modal-body">
						        本当にこのタスクを削除してもよろしいですか？<br>
						        この操作は取り消せません。
						      </div>
						      <div class="modal-footer">
						        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
						        
						        <form th:action="@{|${url.EDIT_TASK}/${task.taskId}/delete|}" method="post">
						            <button type="submit" class="btn btn-danger">削除する</button>
						        </form>
						        
						      </div>
						    </div>
						  </div>
						</div>
						
					</div>
				
			</div>
			
		</main>
	</body>
</html>